# Задание #6 Горизонтальное масштабирование хранилища данных: сегментирование (шардинг)

## Суть проблемы

Имея дело с большим объёмом данных, система рано или поздно упирается в следующие ограничения работы с данными:

1. Ограниченный объём хранилища
2. Ограниченные вычислительные ресурсы
3. Ограниченная пропускная способность сети
4. Географические аспекты пользования системой.

Вертикальное масштабирование дискового пространства, процессорных мощностей и пропускной способности сетевых соединений способно отложить на некоторое время проблемы с вышеуказанными ограничениями. Географические аспекты всегда остаются.

Наиболее лучшим способом решения указанных проблем является горизонтальное масштабирование данных (сегментирование, шардинг, шардирование). При сегментировании данные с одной и той же структурой хранятся и обрабатываются разными узлами (сегментами, шардами).

Для организации сегментирования необходимо:

1. Определить, какие данные на каком сегменте будут располагаться
2. Определить атрибуты, по которым будет определяться принадлежность данных к определённому сегменту. Эти атрибуты называются ключом сегментирования. Этот ключ должен быть постоянным и не зависеть от изменения данных.
3. Определить стратегии распределения данных по сегментам. Стратегия распределения может быть реализована как в приложении на уровне доступа к данным, так и в самом хранилище, если оно поддерживает прозрачность распределения данных.

Виды стратегий сегментирования:

1. Стратегия поиска. Обеспечивает максимальный контроль над настройкой и использованием сегментов. Стратегия основана на карте сопоставления данных определённым сегментам. Из-за необходимости постоянного обращения к данной карте этап поиска для маршрутизации запросов создаёт дополнительные накладные расходы.
2. Стратегия диапазонов. Легко реализуется, не вносит дополнительных существенных накладных расходов. Основной недостаток: стратегия не позволяет обеспечить оптимальную балансировку между сегментами в случае, если данные по диапазону распределены неравномерно, т.е. один диапазон может содержать большое количество записей, другой быть сильно разреженным.
3. Стратегия хэширования. Позволяет распределять данные и нагрузку наиболее равномерно. Маршрутизация выполняется прямо из приложения с использованием хэш-функции. Но к хэш-функции предъявляется ряд требований, такие как скорость вычисления, равномерность распределения. Имеются сложности в случае, если необходимо перераспределить нагрузку между сегментами.

Выбор стратегий и ключа сегментирования зависит от требований к приложению.

## Задание

Делается на основе задания #5. Требуется реализовать сегментирование данных.

Сегментированными данными будут данные, относящиеся к обработке текста - это сам текст и его оценка. 
Ключ сегментирования – *contextId*.  Узлами хранилища будут номера баз данных в *Redis*. Доступ к *Redis*-хранилищу по *contextId* 
должен происходить предварительным определением номера базы данных по выбранной стратегии. 
Стратегия любая на выбор: поиска или хеширования. 
При обращении к базе данных *Redis* в консоль каждого компонента должен выводиться текст с *contextId* и соотвутствующим номером базы.
